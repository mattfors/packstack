import{B as i,D as I,E as s,I as l,K as Q,L as r,M as X,N as a,O as p,P as f,Q as w,R as u,U as v,V as m,W,X as g,a as G,aa as Y,b as U,c as J,ca as h,da as y,e as j,ea as ee,fa as te,g as B,h as z,i as S,j as H,l as Z,la as $,m as q,ma as C,na as oe,oa as ne,p as x,pa as ie,qa as R,ra as re,s as V,sa as c,t as K,ta as pe,ua as ae,va as le,wa as se,xa as de,za as _}from"./chunk-XFWZ4VMK.js";var b=class o{constructor(t){this.workflowPersistence=t}workflowId$=new j(null);childIndex$=new j(0);workFlowViewNode$=H([this.workflowId$]).pipe(q(([t])=>t?this.workflowPersistence.workflow$(t):B(void 0)));parentView$=this.workFlowViewNode$.pipe(S(t=>t?this.composeParent(t):void 0),Z(t=>(console.error("Failed to load workflow:",t),B(void 0))));childView$=H([this.workFlowViewNode$,this.childIndex$]).pipe(S(([t,e])=>{if(t?.children&&t?.children.length>e)return t.children[e]}));load(t,e=0){console.log("workflowId: ",t),console.log("workflowId: ",e),this.workflowId$.next(t),this.childIndex$.next(e)}composeParent(t){if(t.subtype==="stepper"){let e=(t.children??[]).map(d=>({id:d.id,label:d.label,type:d.type,subtype:d.subtype,complete:!1}));return{id:t.id,label:t.label,type:t.type,subtype:"stepper",activeIndex:0,complete:!1,children:e}}return{id:t.id,label:t.label,type:t.type,subtype:t.subtype,complete:!1}}static \u0275fac=function(e){return new(e||o)(V(_))};static \u0275prov=x({token:o,factory:o.\u0275fac,providedIn:"root"})};var P=class o{node;active;static \u0275fac=function(e){return new(e||o)};static \u0275cmp=s({type:o,selectors:[["app-step-renderer"]],inputs:{node:"node",active:"active"},decls:2,vars:3,consts:[[1,"step"]],template:function(e,n){e&1&&(a(0,"div",0),m(1),p()),e&2&&(X("active",n.active),i(),g(" ",n.node.label||n.node.id,`
`))},dependencies:[c],encapsulation:2})};function ke(o,t){if(o&1&&(w(0),f(1,"app-step-renderer",2),u()),o&2){let e=t.$implicit,n=t.index,d=v();i(),r("node",e)("active",n===d.node.activeIndex)}}var M=class o{node;static \u0275fac=function(e){return new(e||o)};static \u0275cmp=s({type:o,selectors:[["app-stepper-renderer"]],inputs:{node:"node"},decls:2,vars:1,consts:[[1,"stepper"],[4,"ngFor","ngForOf"],[3,"node","active"]],template:function(e,n){e&1&&(a(0,"div",0),l(1,ke,2,2,"ng-container",1),p()),e&2&&(i(),r("ngForOf",n.node.children))},dependencies:[c,$,P],encapsulation:2})};function ge(o,t){if(o&1&&f(0,"app-stepper-renderer",5),o&2){let e=v(2);r("node",e.node)}}function he(o,t){o&1&&(w(0),l(1,ge,1,1,"app-stepper-renderer",4),u()),o&2&&(i(),r("ngSwitchCase","stepper"))}function ye(o,t){if(o&1&&(w(0),a(1,"p"),m(2),p(),a(3,"pre"),m(4),h(5,"json"),p(),u()),o&2){let e=v();i(2),g("Unknown workflow subtype: ",e.node.subtype,""),i(2),W(y(5,2,e.node))}}var E=class o{node;isStepperViewNode(t){return t.subtype==="stepper"}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=s({type:o,selectors:[["app-workflow-child-renderer"]],inputs:{node:"node"},decls:5,vars:3,consts:[[3,"ngSwitch"],[1,"workflow-sub-title"],[4,"ngIf"],[4,"ngSwitchDefault"],[3,"node",4,"ngSwitchCase"],[3,"node"]],template:function(e,n){e&1&&(w(0,0),a(1,"h3",1),m(2),p(),l(3,he,2,1,"ng-container",2)(4,ye,6,4,"ng-container",3),u()),e&2&&(r("ngSwitch",n.node.subtype),i(2),W(n.node.label||n.node.id),i(),r("ngIf",n.isStepperViewNode(n.node)))},dependencies:[c,C,oe,ne,ie,re,M],encapsulation:2})};function _e(o,t){if(o&1&&f(0,"app-workflow-child-renderer",3),o&2){let e=v();r("node",e.child)}}var F=class o{node;child;isStepperViewNode(t){return t.subtype==="stepper"}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=s({type:o,selectors:[["app-workflow-renderer"]],inputs:{node:"node",child:"child"},decls:4,vars:2,consts:[[1,"workflow-renderer"],[1,"workflow-title"],[3,"node",4,"ngIf"],[3,"node"]],template:function(e,n){e&1&&(a(0,"div",0)(1,"h2",1),m(2),p(),l(3,_e,1,1,"app-workflow-child-renderer",2),p()),e&2&&(i(2),W(n.node.label||n.node.id),i(),r("ngIf",n.child))},dependencies:[c,C,E],encapsulation:2})};function be(o,t){if(o&1&&(w(0),f(1,"app-workflow-renderer",2),h(2,"async"),u()),o&2){let e,n=t.ngIf,d=v();i(),r("node",n)("child",(e=y(2,2,d.childView$))!==null&&e!==void 0?e:void 0)}}function Ne(o,t){o&1&&(a(0,"p"),m(1,"Loading workflow..."),p())}var T=class o{constructor(t,e){this.route=t;this.composer=e;console.log("reloading workflow route"),this.route.paramMap.subscribe(n=>{let d=n.get("id"),ue=Number(n.get("index")??"0");d&&this.composer.load(d,ue)}),this.parentView$=this.composer.parentView$,this.childView$=this.composer.childView$}parentView$;childView$;static \u0275fac=function(e){return new(e||o)(I(ae),I(b))};static \u0275cmp=s({type:o,selectors:[["app-workflow-route"]],features:[Y([b])],decls:4,vars:3,consts:[["loading",""],[4,"ngIf"],[3,"node","child"]],template:function(e,n){e&1&&(l(0,be,3,4,"ng-container",1),h(1,"async"),l(2,Ne,2,0,"ng-template",null,0,ee)),e&2&&r("ngIf",y(1,1,n.parentView$))},dependencies:[c,C,R,F],encapsulation:2})};var me=[{path:"workflow/:id/:index",component:T},{path:"workflow-admin",loadChildren:()=>import("./chunk-SNCG4D7K.js").then(o=>o.WorkflowAdminModule)}];var ce=[{_id:"workflow:hello-world",id:"hello-world",label:"Hello World Demo",type:"workflow",children:[{id:"step-1",_id:"step-1",type:"workflow",subtype:"stepper",label:"Say Hello",children:[{id:"step-1-1",_id:"step-1-1",subtype:"step",label:"Greeting"},{id:"step-1-2",_id:"step-1-2",subtype:"step",label:"Goodbye"}]},{id:"step-2",_id:"step-2",type:"workflow",subtype:"stepper",label:"Say Hola",children:[{id:"step-2-1",_id:"step-2-1",subtype:"step",label:"Buenos dias!"},{id:"step-2-2",_id:"step-2-2",subtype:"step",label:"Buenos noches!"}]}]},{_id:"workflow:picking",id:"picking",label:"Picking",type:"workflow",children:[{id:"list-work",_id:"list-work",type:"workflow",subtype:"table",label:"List Work"},{id:"perform-work",_id:"perform-work",type:"workflow",subtype:"stepper",label:"Pick",children:[{id:"scan-bin",_id:"scan-bin",subtype:"step",label:"Scan Bin"},{id:"scan-carton",_id:"scan-carton",subtype:"step",label:"Scan Carton"},{id:"country-of-origin",_id:"country-of-origin",subtype:"step",label:"Verify Country of Origin"},{id:"scan-parts",_id:"scan-parts",subtype:"step",label:"Scan Parts"},{id:"rescan-carton",_id:"rescan-carton",subtype:"step",label:"ReScan Carton"}]}]}];function fe(){return Q(()=>{let o=K(_);return J(null,null,function*(){for(let t of ce){let e=`workflow:${t.id}`;try{let n=yield z(o.workflow$(e)),d=U(G({},t),{_id:e,_rev:n?._rev});yield z(o.saveWorkflow(d)),console.log(`${n?"Updated":"Created"}: ${e}`)}catch(n){console.error(`Error writing ${e}:`,n)}}})})}var we={providers:[te({eventCoalescing:!0}),de(me),fe()]};var L=class o{constructor(t){this.workflowPersistence=t;this.navViewModel$=this.workflowPersistence.allWorkflows$().pipe(S(e=>e.map(n=>this.toNavItem(n))))}navViewModel$;toNavItem(t){return console.log("workflow:",t),{label:t.label||t._id,route:`/workflow/${t._id}/0`,children:(t.children??[]).map((e,n)=>({label:e.label??`Step ${n+1}`,route:`/workflow/${t._id}/${n}`}))}}static \u0275fac=function(e){return new(e||o)(V(_))};static \u0275prov=x({token:o,factory:o.\u0275fac,providedIn:"root"})};function Ie(o,t){if(o&1&&(w(0),a(1,"li")(2,"a",6),m(3),p()(),u()),o&2){let e=t.$implicit;i(2),r("routerLink",e.route),i(),g(" ",e.label," ")}}function We(o,t){if(o&1&&(a(0,"ul",5),l(1,Ie,4,2,"ng-container",2),p()),o&2){let e=v().$implicit;i(),r("ngForOf",e.children)}}function xe(o,t){if(o&1&&(w(0),a(1,"li")(2,"a",3),m(3),p(),l(4,We,2,1,"ul",4),p(),u()),o&2){let e=t.$implicit;i(2),r("routerLink",e.route),i(),g(" ",e.label," "),i(),r("ngIf",e.children==null?null:e.children.length)}}function Ve(o,t){if(o&1&&(a(0,"ul",1),l(1,xe,5,3,"ng-container",2),p()),o&2){let e=t.ngIf;i(),r("ngForOf",e)}}var A=class o{constructor(t){this.navComposer=t;this.navItems$=this.navComposer.navViewModel$}navItems$;static \u0275fac=function(e){return new(e||o)(I(L))};static \u0275cmp=s({type:o,selectors:[["app-nav-list"]],decls:2,vars:3,consts:[["class","nav-list",4,"ngIf"],[1,"nav-list"],[4,"ngFor","ngForOf"],[1,"nav-link",3,"routerLink"],["class","nav-child-list",4,"ngIf"],[1,"nav-child-list"],[1,"nav-child-link",3,"routerLink"]],template:function(e,n){e&1&&(l(0,Ve,2,1,"ul",0),h(1,"async")),e&2&&r("ngIf",y(1,1,n.navItems$))},dependencies:[c,$,C,R,se],encapsulation:2})};var O=class o{title="packstack";static \u0275fac=function(e){return new(e||o)};static \u0275cmp=s({type:o,selectors:[["app-root"]],decls:4,vars:0,consts:[[1,"app-shell"],[1,"app-shell__nav"],[1,"app-shell__content"]],template:function(e,n){e&1&&(a(0,"div",0),f(1,"app-nav-list",1),a(2,"div",2),f(3,"router-outlet"),p()())},dependencies:[le,A],encapsulation:2})};pe(O,we).catch(o=>console.error(o));
