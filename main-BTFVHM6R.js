import{B as i,D as I,E as s,I as l,K as q,L as r,M as K,N as a,O as p,P as f,Q as u,R as w,U as v,V as m,W,X as h,aa as Q,c as H,ca as y,da as g,e as j,ea as X,fa as Y,g as B,h as G,i as S,j as z,l as U,la as R,m as J,ma as C,na as ee,oa as te,p as x,pa as oe,qa as $,ra as ne,s as V,sa as d,t as Z,ta as ie,ua as re,va as pe,wa as ae,xa as le,za as b}from"./chunk-ZAVCQ7J5.js";var _=class o{constructor(t){this.workflowPersistence=t}workflowId$=new j(null);childIndex$=new j(0);workFlowViewNode$=z([this.workflowId$]).pipe(J(([t])=>t?this.workflowPersistence.workflow$(t):B(void 0)));parentView$=this.workFlowViewNode$.pipe(S(t=>t?this.composeParent(t):void 0),U(t=>(console.error("Failed to load workflow:",t),B(void 0))));childView$=z([this.workFlowViewNode$,this.childIndex$]).pipe(S(([t,e])=>{if(t?.children&&t?.children.length>e)return t.children[e]}));load(t,e=0){console.log("workflowId: ",t),console.log("workflowId: ",e),this.workflowId$.next(t),this.childIndex$.next(e)}composeParent(t){if(t.subtype==="stepper"){let e=(t.children??[]).map(c=>({id:c.id,label:c.label,type:c.type,subtype:c.subtype,complete:!1}));return{id:t.id,label:t.label,type:t.type,subtype:"stepper",activeIndex:0,complete:!1,children:e}}return{id:t.id,label:t.label,type:t.type,subtype:t.subtype,complete:!1}}static \u0275fac=function(e){return new(e||o)(V(b))};static \u0275prov=x({token:o,factory:o.\u0275fac,providedIn:"root"})};var P=class o{node;active;static \u0275fac=function(e){return new(e||o)};static \u0275cmp=s({type:o,selectors:[["app-step-renderer"]],inputs:{node:"node",active:"active"},decls:2,vars:3,consts:[[1,"step"]],template:function(e,n){e&1&&(a(0,"div",0),m(1),p()),e&2&&(K("active",n.active),i(),h(" ",n.node.label||n.node.id,`
`))},dependencies:[d],encapsulation:2})};function ve(o,t){if(o&1&&(u(0),f(1,"app-step-renderer",2),w()),o&2){let e=t.$implicit,n=t.index,c=v();i(),r("node",e)("active",n===c.node.activeIndex)}}var M=class o{node;static \u0275fac=function(e){return new(e||o)};static \u0275cmp=s({type:o,selectors:[["app-stepper-renderer"]],inputs:{node:"node"},decls:2,vars:1,consts:[[1,"stepper"],[4,"ngFor","ngForOf"],[3,"node","active"]],template:function(e,n){e&1&&(a(0,"div",0),l(1,ve,2,2,"ng-container",1),p()),e&2&&(i(),r("ngForOf",n.node.children))},dependencies:[d,R,P],encapsulation:2})};function Ce(o,t){if(o&1&&f(0,"app-stepper-renderer",5),o&2){let e=v(2);r("node",e.node)}}function ke(o,t){o&1&&(u(0),l(1,Ce,1,1,"app-stepper-renderer",4),w()),o&2&&(i(),r("ngSwitchCase","stepper"))}function he(o,t){if(o&1&&(u(0),a(1,"p"),m(2),p(),a(3,"pre"),m(4),y(5,"json"),p(),w()),o&2){let e=v();i(2),h("Unknown workflow subtype: ",e.node.subtype,""),i(2),W(g(5,2,e.node))}}var F=class o{node;isStepperViewNode(t){return t.subtype==="stepper"}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=s({type:o,selectors:[["app-workflow-child-renderer"]],inputs:{node:"node"},decls:5,vars:3,consts:[[3,"ngSwitch"],[1,"workflow-sub-title"],[4,"ngIf"],[4,"ngSwitchDefault"],[3,"node",4,"ngSwitchCase"],[3,"node"]],template:function(e,n){e&1&&(u(0,0),a(1,"h3",1),m(2),p(),l(3,ke,2,1,"ng-container",2)(4,he,6,4,"ng-container",3),w()),e&2&&(r("ngSwitch",n.node.subtype),i(2),W(n.node.label||n.node.id),i(),r("ngIf",n.isStepperViewNode(n.node)))},dependencies:[d,C,ee,te,oe,ne,M],encapsulation:2})};function ye(o,t){if(o&1&&f(0,"app-workflow-child-renderer",3),o&2){let e=v();r("node",e.child)}}var E=class o{node;child;isStepperViewNode(t){return t.subtype==="stepper"}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=s({type:o,selectors:[["app-workflow-renderer"]],inputs:{node:"node",child:"child"},decls:4,vars:2,consts:[[1,"workflow-renderer"],[1,"workflow-title"],[3,"node",4,"ngIf"],[3,"node"]],template:function(e,n){e&1&&(a(0,"div",0)(1,"h2",1),m(2),p(),l(3,ye,1,1,"app-workflow-child-renderer",2),p()),e&2&&(i(2),W(n.node.label||n.node.id),i(),r("ngIf",n.child))},dependencies:[d,C,F],encapsulation:2})};function ge(o,t){if(o&1&&(u(0),f(1,"app-workflow-renderer",2),y(2,"async"),w()),o&2){let e,n=t.ngIf,c=v();i(),r("node",n)("child",(e=g(2,2,c.childView$))!==null&&e!==void 0?e:void 0)}}function be(o,t){o&1&&(a(0,"p"),m(1,"Loading workflow..."),p())}var T=class o{constructor(t,e){this.route=t;this.composer=e;console.log("reloading workflow route"),this.route.paramMap.subscribe(n=>{let c=n.get("id"),fe=Number(n.get("index")??"0");c&&this.composer.load(c,fe)}),this.parentView$=this.composer.parentView$,this.childView$=this.composer.childView$}parentView$;childView$;static \u0275fac=function(e){return new(e||o)(I(re),I(_))};static \u0275cmp=s({type:o,selectors:[["app-workflow-route"]],features:[Q([_])],decls:4,vars:3,consts:[["loading",""],[4,"ngIf"],[3,"node","child"]],template:function(e,n){e&1&&(l(0,ge,3,4,"ng-container",1),y(1,"async"),l(2,be,2,0,"ng-template",null,0,X)),e&2&&r("ngIf",g(1,1,n.parentView$))},dependencies:[d,C,$,E],encapsulation:2})};var se=[{path:"workflow/:id/:index",component:T},{path:"workflow-admin",loadChildren:()=>import("./chunk-SINQKXIX.js").then(o=>o.WorkflowAdminModule)}];var me=[{id:"hello-world",label:"Hello World Demo",type:"workflow",children:[{id:"step-1",type:"workflow",subtype:"stepper",label:"Say Hello",children:[{id:"step-1-1",subtype:"step",label:"Greeting"},{id:"step-1-2",subtype:"step",label:"Goodbye"}]},{id:"step-2",type:"workflow",subtype:"stepper",label:"Say Hola",children:[{id:"step-2-1",subtype:"step",label:"Buenos dias!"},{id:"step-2-2",subtype:"step",label:"Buenos noches!"}]}]},{id:"picking",label:"Picking",type:"workflow",children:[{id:"list-work",type:"workflow",subtype:"table",label:"List Work"},{id:"perform-work",type:"workflow",subtype:"stepper",label:"Pick",children:[{id:"scan-bin",subtype:"step",label:"Scan Bin"},{id:"scan-carton",subtype:"step",label:"Scan Carton"},{id:"country-of-origin",subtype:"step",label:"Verify Country of Origin"},{id:"scan-parts",subtype:"step",label:"Scan Parts"},{id:"rescan-carton",subtype:"step",label:"ReScan Carton"}]}]}];function de(){return q(()=>H(null,null,function*(){let o=Z(b);yield G(o.installOrUpdateMany(me))}))}var ce={providers:[Y({eventCoalescing:!0}),le(se),de()]};var L=class o{constructor(t){this.workflowPersistence=t;this.navViewModel$=this.workflowPersistence.allWorkflows$().pipe(S(e=>e.map(n=>this.toNavItem(n))))}navViewModel$;toNavItem(t){return console.log("workflow:",t),{label:t.label||t.id,route:`/workflow/${t.id}/0`,children:(t.children??[]).map((e,n)=>({label:e.label??`Step ${n+1}`,route:`/workflow/${t.id}/${n}`}))}}static \u0275fac=function(e){return new(e||o)(V(b))};static \u0275prov=x({token:o,factory:o.\u0275fac,providedIn:"root"})};function Ne(o,t){if(o&1&&(u(0),a(1,"li")(2,"a",6),m(3),p()(),w()),o&2){let e=t.$implicit;i(2),r("routerLink",e.route),i(),h(" ",e.label," ")}}function Se(o,t){if(o&1&&(a(0,"ul",5),l(1,Ne,4,2,"ng-container",2),p()),o&2){let e=v().$implicit;i(),r("ngForOf",e.children)}}function Ie(o,t){if(o&1&&(u(0),a(1,"li")(2,"a",3),m(3),p(),l(4,Se,2,1,"ul",4),p(),w()),o&2){let e=t.$implicit;i(2),r("routerLink",e.route),i(),h(" ",e.label," "),i(),r("ngIf",e.children==null?null:e.children.length)}}function We(o,t){if(o&1&&(a(0,"ul",1),l(1,Ie,5,3,"ng-container",2),p()),o&2){let e=t.ngIf;i(),r("ngForOf",e)}}var A=class o{constructor(t){this.navComposer=t;this.navItems$=this.navComposer.navViewModel$}navItems$;static \u0275fac=function(e){return new(e||o)(I(L))};static \u0275cmp=s({type:o,selectors:[["app-nav-list"]],decls:2,vars:3,consts:[["class","nav-list",4,"ngIf"],[1,"nav-list"],[4,"ngFor","ngForOf"],[1,"nav-link",3,"routerLink"],["class","nav-child-list",4,"ngIf"],[1,"nav-child-list"],[1,"nav-child-link",3,"routerLink"]],template:function(e,n){e&1&&(l(0,We,2,1,"ul",0),y(1,"async")),e&2&&r("ngIf",g(1,1,n.navItems$))},dependencies:[d,R,C,$,ae],encapsulation:2})};var O=class o{title="packstack";static \u0275fac=function(e){return new(e||o)};static \u0275cmp=s({type:o,selectors:[["app-root"]],decls:4,vars:0,consts:[[1,"app-shell"],[1,"app-shell__nav"],[1,"app-shell__content"]],template:function(e,n){e&1&&(a(0,"div",0),f(1,"app-nav-list",1),a(2,"div",2),f(3,"router-outlet"),p()())},dependencies:[pe,A],encapsulation:2})};ie(O,ce).catch(o=>console.error(o));
